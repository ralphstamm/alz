if (user.isNewSession) {

function SHA512(f){function a(a,b){this.highOrder=a,this.lowOrder=b;}function G(a){return unescape(encodeURIComponent(a));}function D(c){var b=[];var d=(1<<i)-1;var e=c.length*i;for(var a=0;a<e;a+=i)b[a>>5]|=(c.charCodeAt(a/ i)&d)<<32-i-a%32;return b;}function C(e){var b='0123456789abcdef';var c='';var f=e.length*4;var d;for(var a=0;a<f;a+=1)d=e[a>>2]>>(3-a%4)*8,c+=b.charAt(d>>4&15)+b.charAt(d&15);return c;}function e(d,e){var b,c,f,g;return b=(d.lowOrder&65535)+(e.lowOrder&65535),c=(d.lowOrder>>>16)+(e.lowOrder>>>16)+(b>>>16),f=(c&65535)<<16|b&65535,b=(d.highOrder&65535)+(e.highOrder&65535)+(c>>>16),c=(d.highOrder>>>16)+(e.highOrder>>>16)+(b>>>16),g=(c&65535)<<16|b&65535,new a(g,f);}function B(d,e,f,g){var b,c,h,i;return b=(d.lowOrder&65535)+(e.lowOrder&65535)+(f.lowOrder&65535)+(g.lowOrder&65535),c=(d.lowOrder>>>16)+(e.lowOrder>>>16)+(f.lowOrder>>>16)+(g.lowOrder>>>16)+(b>>>16),h=(c&65535)<<16|b&65535,b=(d.highOrder&65535)+(e.highOrder&65535)+(f.highOrder&65535)+(g.highOrder&65535)+(c>>>16),c=(d.highOrder>>>16)+(e.highOrder>>>16)+(f.highOrder>>>16)+(g.highOrder>>>16)+(b>>>16),i=(c&65535)<<16|b&65535,new a(i,h);}function A(d,e,f,g,h){var b,c,i,j;return b=(d.lowOrder&65535)+(e.lowOrder&65535)+(f.lowOrder&65535)+(g.lowOrder&65535)+(h.lowOrder&65535),c=(d.lowOrder>>>16)+(e.lowOrder>>>16)+(f.lowOrder>>>16)+(g.lowOrder>>>16)+(h.lowOrder>>>16)+(b>>>16),i=(c&65535)<<16|b&65535,b=(d.highOrder&65535)+(e.highOrder&65535)+(f.highOrder&65535)+(g.highOrder&65535)+(h.highOrder&65535)+(c>>>16),c=(d.highOrder>>>16)+(e.highOrder>>>16)+(f.highOrder>>>16)+(g.highOrder>>>16)+(h.highOrder>>>16)+(b>>>16),j=(c&65535)<<16|b&65535,new a(j,i);}function z(b,c,d){return new a(b.highOrder&c.highOrder^b.highOrder&d.highOrder^c.highOrder&d.highOrder,b.lowOrder&c.lowOrder^b.lowOrder&d.lowOrder^c.lowOrder&d.lowOrder);}function y(b,c,d){return new a(b.highOrder&c.highOrder^~b.highOrder&d.highOrder,b.lowOrder&c.lowOrder^~b.lowOrder&d.lowOrder);}function g(c,b){return b<=32?new a(c.highOrder>>>b|c.lowOrder<<32-b,c.lowOrder>>>b|c.highOrder<<32-b):new a(c.lowOrder>>>b|c.highOrder<<32-b,c.highOrder>>>b|c.lowOrder<<32-b);}function x(b){var c=g(b,28);var d=g(b,34);var e=g(b,39);return new a(c.highOrder^d.highOrder^e.highOrder,c.lowOrder^d.lowOrder^e.lowOrder);}function w(b){var c=g(b,14);var d=g(b,18);var e=g(b,41);return new a(c.highOrder^d.highOrder^e.highOrder,c.lowOrder^d.lowOrder^e.lowOrder);}function F(b){var c=g(b,1),d=g(b,8),e=u(b,7);return new a(c.highOrder^d.highOrder^e.highOrder,c.lowOrder^d.lowOrder^e.lowOrder);}function E(b){var c=g(b,19);var d=g(b,61);var e=u(b,6);return new a(c.highOrder^d.highOrder^e.highOrder,c.lowOrder^d.lowOrder^e.lowOrder);}function u(c,b){return b<=32?new a(c.highOrder>>>b,c.lowOrder>>>b|c.highOrder<<32-b):new a(0,c.highOrder<<32-b);}var b=[new a(1779033703,4089235720),new a(3144134277,2227873595),new a(1013904242,4271175723),new a(2773480762,1595750129),new a(1359893119,2917565137),new a(2600822924,725511199),new a(528734635,4215389547),new a(1541459225,327033209)];var t=[new a(1116352408,3609767458),new a(1899447441,602891725),new a(3049323471,3964484399),new a(3921009573,2173295548),new a(961987163,4081628472),new a(1508970993,3053834265),new a(2453635748,2937671579),new a(2870763221,3664609560),new a(3624381080,2734883394),new a(310598401,1164996542),new a(607225278,1323610764),new a(1426881987,3590304994),new a(1925078388,4068182383),new a(2162078206,991336113),new a(2614888103,633803317),new a(3248222580,3479774868),new a(3835390401,2666613458),new a(4022224774,944711139),new a(264347078,2341262773),new a(604807628,2007800933),new a(770255983,1495990901),new a(1249150122,1856431235),new a(1555081692,3175218132),new a(1996064986,2198950837),new a(2554220882,3999719339),new a(2821834349,766784016),new a(2952996808,2566594879),new a(3210313671,3203337956),new a(3336571891,1034457026),new a(3584528711,2466948901),new a(113926993,3758326383),new a(338241895,168717936),new a(666307205,1188179964),new a(773529912,1546045734),new a(1294757372,1522805485),new a(1396182291,2643833823),new a(1695183700,2343527390),new a(1986661051,1014477480),new a(2177026350,1206759142),new a(2456956037,344077627),new a(2730485921,1290863460),new a(2820302411,3158454273),new a(3259730800,3505952657),new a(3345764771,106217008),new a(3516065817,3606008344),new a(3600352804,1432725776),new a(4094571909,1467031594),new a(275423344,851169720),new a(430227734,3100823752),new a(506948616,1363258195),new a(659060556,3750685593),new a(883997877,3785050280),new a(958139571,3318307427),new a(1322822218,3812723403),new a(1537002063,2003034995),new a(1747873779,3602036899),new a(1955562222,1575990012),new a(2024104815,1125592928),new a(2227730452,2716904306),new a(2361852424,442776044),new a(2428436474,593698344),new a(2756734187,3733110249),new a(3204031479,2999351573),new a(3329325298,3815920427),new a(3391569614,3928383900),new a(3515267271,566280711),new a(3940187606,3454069534),new a(4118630271,4000239992),new a(116418474,1914138554),new a(174292421,2731055270),new a(289380356,3203993006),new a(460393269,320620315),new a(685471733,587496836),new a(852142971,1086792851),new a(1017036298,365543100),new a(1126000580,2618297676),new a(1288033470,3409855158),new a(1501505948,4234509866),new a(1607167915,987167468),new a(1816402316,1246189591)];var h=new Array(64);var k,n,m,p,j,o,l,r,d,c;var s,v;var i=8;f=G(f),strlen=f.length*i,f=D(f),f[strlen>>5]|=128<<24-strlen%32,f[(strlen+128>>10<<5)+31]=strlen;for(var d=0;d<f.length;d+=32){k=b[0],n=b[1],m=b[2],p=b[3],j=b[4],o=b[5],l=b[6],r=b[7];for(var c=0;c<80;c++)c<16?h[c]=new a(f[c*2+d],f[c*2+d+1]):h[c]=B(E(h[c-2]),h[c-7],F(h[c-15]),h[c-16]),s=A(r,w(j),y(j,o,l),t[c],h[c]),v=e(x(k),z(k,n,m)),r=l,l=o,o=j,j=e(p,s),p=m,m=n,n=k,k=e(s,v);b[0]=e(k,b[0]),b[1]=e(n,b[1]),b[2]=e(m,b[2]),b[3]=e(p,b[3]),b[4]=e(j,b[4]),b[5]=e(o,b[5]),b[6]=e(l,b[6]),b[7]=e(r,b[7]);}var q=[];for(var d=0;d<b.length;d++)q.push(b[d].highOrder),q.push(b[d].lowOrder);return C(q);}


return SHA512(user.header('x-cluster-client-ip'));
}
